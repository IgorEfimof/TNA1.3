<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="apple-touch-icon" sizes="180x180" href="icons/icon231.png">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TNA8">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>TT Analyzer 8.0 ‚Äî Live Trading System</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
:root{
--bg:#08090e;
--card:#141721;
--accent:#2563eb;
--good:#22c55e;
--warn:#f59e0b;
--bad:#ef4444;
--text:#e5e7eb;
--muted:#9ca3af;
}

*{
box-sizing:border-box;
font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",sans-serif;
}

body{
margin:0;
background:var(--bg);
color:var(--text);
}

.container{
max-width:440px;
margin:auto;
padding:14px;
}

h1{
text-align:center;
font-size:22px;
margin-bottom:10px;
}

.card{
background:var(--card);
border-radius:16px;
padding:16px;
margin-bottom:14px;
}

.upload{
background:var(--accent);
color:#fff;
padding:14px;
text-align:center;
border-radius:12px;
font-size:16px;
cursor:pointer;
}

input[type=file]{display:none;}

input[type=number]{
width:100%;
padding:12px;
border-radius:10px;
border:none;
margin-top:6px;
font-size:15px;
}

label{
font-size:13px;
color:var(--muted);
}

.row{
display:flex;
justify-content:space-between;
padding:6px 0;
border-bottom:1px solid #222;
font-size:14px;
}

.row:last-child{border:none;}

.block{
margin-top:12px;
padding:14px;
border-radius:12px;
}

.good{background:rgba(34,197,94,.12);}
.warn{background:rgba(245,158,11,.12);}
.bad{background:rgba(239,68,68,.12);}

.highlight{
font-size:16px;
font-weight:600;
margin-bottom:6px;
}

button{
width:100%;
padding:12px;
border-radius:10px;
border:none;
margin-top:8px;
font-size:15px;
cursor:pointer;
}

.btn-good{background:var(--good);color:#000;}
.btn-warn{background:var(--warn);color:#000;}
.btn-bad{background:var(--bad);color:#fff;}
</style>
</head>

<body>
<div class="container">

<h1>üèì TT Analyzer 8.0</h1>

<div class="card">
<label class="upload">
üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç—å LIVE-–ª–∏–Ω–∏—é
<input type="file" accept="image/*" onchange="analyze(event)">
</label>
</div>

<div class="card">
<label>–ë–∞–Ω–∫</label>
<input type="number" id="bank" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 1000">
<label>–†–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É (%)</label>
<input type="number" id="risk" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 2">
</div>

<div class="card" id="output">
–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç
</div>

<div class="card">
<div class="highlight">üìä –ñ—É—Ä–Ω–∞–ª —Å–¥–µ–ª–æ–∫</div>
<div id="log"></div>
</div>

<div class="card">
<div class="highlight">üìà ROI-–∞–Ω–∞–ª–∏–∑</div>
<div id="roi"></div>
</div>

</div>

<script>
let currentTrade=null;
let trades=JSON.parse(localStorage.getItem('tt_trades')||'[]');

renderLog();
renderROI();

function analyze(e){
Tesseract.recognize(
e.target.files[0],
'rus'
).then(r=>{
parseLine(r.data.text);
});
}

function parseLine(text){
const odds=text.match(/\d\.\d{2}/g);
if(!odds||odds.length<10){
document.getElementById('output').innerHTML='‚ùå –õ–∏–Ω–∏—è –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞';
return;
}

const nums=odds.map(Number);
let totals=[
{line:16.5, tm:nums[2], tb:nums[3]},
{line:17.5, tm:nums[4], tb:nums[5]},
{line:18.5, tm:nums[6], tb:nums[7]},
{line:19.5, tm:nums[8], tb:nums[9]},
{line:20.5, tm:nums[10], tb:nums[11]}
];

let candidates=[];
totals.forEach(t=>{
let min=Math.min(t.tm,t.tb);
let max=Math.max(t.tm,t.tb);
if(min>=1.70){
candidates.push({
line:t.line,
side:t.tm>t.tb?'–¢–ë':'–¢–ú',
odd:min,
edge:(max-min)*min
});
}
});

candidates.sort((a,b)=>b.edge-a.edge);
if(!candidates.length){
document.getElementById('output').innerHTML='‚ùå –ù–µ—Ç value ‚â•1.70';
return;
}

let bet=candidates[0];
let bank=Number(document.getElementById('bank').value);
let risk=Number(document.getElementById('risk').value);
let stake=((bank*risk)/100).toFixed(2);

currentTrade={bet,stake};

document.getElementById('output').innerHTML=`
<div class="block good">
<div class="highlight">‚≠ê –°–¥–µ–ª–∫–∞</div>
${bet.side} ${bet.line} @ ${bet.odd}<br>
–°—Ç–∞–≤–∫–∞: ${stake}
</div>

<button class="btn-good" onclick="closeTrade('win')">‚úîÔ∏è Win</button>
<button class="btn-bad" onclick="closeTrade('lose')">‚ùå Lose</button>
`;
}

function closeTrade(result){
let profit=result==='win'
? currentTrade.stake*(currentTrade.bet.odd-1)
: -currentTrade.stake;

trades.push({
date:new Date().toLocaleString(),
bet:`${currentTrade.bet.side} ${currentTrade.bet.line}`,
odd:currentTrade.bet.odd,
stake:currentTrade.stake,
profit:profit
});

localStorage.setItem('tt_trades',JSON.stringify(trades));
renderLog();
renderROI();
document.getElementById('output').innerHTML='–°–¥–µ–ª–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞';
}

function renderLog(){
const el=document.getElementById('log');
el.innerHTML='';
trades.slice().reverse().forEach(t=>{
el.innerHTML+=`
<div class="row">
<span>${t.bet} @ ${t.odd}</span>
<b style="color:${t.profit>=0?'#22c55e':'#ef4444'}">
${t.profit.toFixed(2)}
</b>
</div>`;
});
}

function renderROI(){
const el=document.getElementById('roi');
let total=trades.length;
let profit=trades.reduce((a,b)=>a+b.profit,0);
let staked=trades.reduce((a,b)=>a+Number(b.stake),0);
let roi=staked? (profit/staked*100):0;

el.innerHTML=`
<div class="row"><span>–°–¥–µ–ª–æ–∫</span><b>${total}</b></div>
<div class="row"><span>–ü—Ä–æ—Ñ–∏—Ç</span><b>${profit.toFixed(2)}</b></div>
<div class="row"><span>ROI</span><b>${roi.toFixed(1)}%</b></div>
`;
}
</script>

</body>
</html>

