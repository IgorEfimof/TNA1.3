<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TT Analyzer 2.0</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
:root {
    --bg:#0b0c10;
    --card:#161821;
    --accent:#2563eb;
    --good:#22c55e;
    --warn:#f59e0b;
    --bad:#ef4444;
    --text:#e5e7eb;
    --muted:#9ca3af;
}

* {
    box-sizing:border-box;
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",sans-serif;
}

body {
    margin:0;
    background:var(--bg);
    color:var(--text);
}

.container {
    max-width:430px;
    margin:auto;
    padding:14px;
}

h1 {
    text-align:center;
    font-size:22px;
    margin-bottom:12px;
}

.card {
    background:var(--card);
    border-radius:16px;
    padding:16px;
    margin-bottom:14px;
}

.upload {
    background:var(--accent);
    color:#fff;
    padding:14px;
    text-align:center;
    border-radius:12px;
    font-size:16px;
    cursor:pointer;
}

input { display:none; }

.status {
    text-align:center;
    margin-top:8px;
    font-size:13px;
    color:var(--muted);
}

.row {
    display:flex;
    justify-content:space-between;
    padding:6px 0;
    border-bottom:1px solid #222;
    font-size:14px;
}

.row:last-child { border:none; }

.tag {
    padding:4px 10px;
    border-radius:999px;
    font-size:12px;
}

.good { background:rgba(34,197,94,.15); color:var(--good); }
.warn { background:rgba(245,158,11,.15); color:var(--warn); }

.forecast {
    background:#0f1d38;
    border-left:4px solid var(--accent);
    padding:14px;
    border-radius:10px;
    margin-top:10px;
    font-size:14px;
}
</style>
</head>

<body>

<div class="container">
<h1>üèì TT Analyzer 2.0</h1>

<div class="card">
<label class="upload">
üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç
<input type="file" accept="image/*" onchange="analyze(event)">
</label>
<div class="status" id="status"></div>
</div>

<div class="card" id="output">
–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
</div>
</div>

<script>
function analyze(e) {
    const status=document.getElementById('status');
    const out=document.getElementById('output');
    out.innerHTML='';
    status.innerText='‚è≥ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ...';

    Tesseract.recognize(
        e.target.files[0],
        'rus',
        { logger:m=>status.innerText=`‚è≥ ${Math.round(m.progress*100)}%` }
    ).then(r=>{
        status.innerText='‚úÖ –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤';
        parseText(r.data.text);
    });
}

function parseText(text) {
    const lines=text.split('\n').map(l=>l.trim()).filter(l=>l);
    let matches=[];

    for(let i=0;i<lines.length;i++){
        if(lines[i].match(/\d:\d/) && lines[i].includes('('))
            matches.push(lines[i]);
    }

    let total=matches.length;
    let s3_0=0,s3_1=0,s3_2=0;
    let sets=0,points=0,five=0;

    matches.forEach(m=>{
        const score=m.match(/(\d):(\d)/);
        const setsData=m.match(/\((.*?)\)/)[1].split(',');
        const cnt=setsData.length;

        sets+=cnt;
        if(cnt===5) five++;

        if(score[1]==3 && score[2]==0) s3_0++;
        if(score[1]==3 && score[2]==1) s3_1++;
        if(score[1]==3 && score[2]==2) s3_2++;

        setsData.forEach(s=>{
            let [a,b]=s.split(':').map(Number);
            points+=a+b;
        });
    });

    let avgSets=(sets/total).toFixed(2);
    let avgPoints=(points/total).toFixed(1);
    let avgSetPoints=(points/sets).toFixed(1);

    let profile=avgSets>=4 ? '–î–ª–∏–Ω–Ω–∞—è –ª–∏–≥–∞' : '–ö–æ—Ä–æ—Ç–∫–∞—è –ª–∏–≥–∞';
    let mainBet=avgSets>=4 ? '–¢–ë –ø–æ —Å–µ—Ç–∞–º (3.5)' : '–ü–æ–±–µ–¥–∞ 3:0 / 3:1';
    let altBet=avgSetPoints>18 ? '–¢–ë –æ—á–∫–æ–≤' : '–¢–ú –æ—á–∫–æ–≤';

    document.getElementById('output').innerHTML=`
    <div class="row"><span>–ú–∞—Ç—á–µ–π</span><b>${total}</b></div>
    <div class="row"><span>–°—Ä–µ–¥–Ω–µ–µ —Å–µ—Ç–æ–≤</span><b>${avgSets}</b></div>
    <div class="row"><span>–°—Ä–µ–¥–Ω–∏–π —Ç–æ—Ç–∞–ª</span><b>${avgPoints}</b></div>
    <div class="row"><span>–û—á–∫–æ–≤ –≤ —Å–µ—Ç–µ</span><b>${avgSetPoints}</b></div>

    <div class="row"><span>3:0</span><b>${s3_0}</b></div>
    <div class="row"><span>3:1</span><b>${s3_1}</b></div>
    <div class="row"><span>3:2</span><b>${s3_2}</b></div>

    <div class="row">
        <span>–¢–∏–ø –ª–∏–≥–∏</span>
        <span class="tag ${avgSets>=4?'good':'warn'}">${profile}</span>
    </div>

    <div class="forecast">
        ‚≠ê <b>–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç–∞–≤–∫—É:</b><br><br>
        –û—Å–Ω–æ–≤–Ω–∞—è: <b>${mainBet}</b><br>
        –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: <b>${altBet}</b><br><br>
        ‚ùå –ò–∑–±–µ–≥–∞—Ç—å —Å—Ç–∞–≤–æ–∫ ¬´–Ω–∞ —Ç–æ—á–Ω—ã–π —Å—á—ë—Ç¬ª, –µ—Å–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ ‚â• 4 —Å–µ—Ç–æ–≤
    </div>
    `;
}
</script>

</body>
</html>

