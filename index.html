<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="apple-touch-icon" sizes="180x180" href="icons/icon231.png">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TNA12">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>TT Live Analyzer ‚Äî Early Set</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
:root{
--bg:#05060b;
--card:#121526;
--accent:#2563eb;
--good:#22c55e;
--warn:#f59e0b;
--bad:#ef4444;
--text:#e5e7eb;
--muted:#9ca3af;
}

*{
box-sizing:border-box;
font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",sans-serif;
}

body{
margin:0;
background:var(--bg);
color:var(--text);
}

.container{
max-width:460px;
margin:auto;
padding:14px;
}

h1{
text-align:center;
font-size:22px;
margin-bottom:12px;
}

.card{
background:var(--card);
border-radius:16px;
padding:16px;
margin-bottom:14px;
}

.upload{
background:var(--accent);
color:#fff;
padding:14px;
border-radius:12px;
text-align:center;
font-size:16px;
cursor:pointer;
}

input[type=file]{display:none;}

.row{
display:flex;
justify-content:space-between;
padding:6px 0;
border-bottom:1px solid #222;
font-size:14px;
}

.row:last-child{border:none;}

.block{
margin-top:12px;
padding:14px;
border-radius:12px;
}

.good{background:rgba(34,197,94,.15);}
.warn{background:rgba(245,158,11,.15);}
.bad{background:rgba(239,68,68,.15);}

.highlight{
font-size:16px;
font-weight:600;
margin-bottom:6px;
}

.small{
font-size:13px;
color:var(--muted);
}

.decision{
font-size:20px;
font-weight:700;
text-align:center;
margin-top:10px;
}
</style>
</head>

<body>
<div class="container">

<h1>üèì TT Live Analyzer</h1>

<div class="card">
<label class="upload">
üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–Ω LIVE (–ø–æ—Å–ª–µ 1-–π –ø–∞—Ä—Ç–∏–∏)
<input type="file" accept="image/*" onchange="analyze(event)">
</label>
<div class="small" id="status"></div>
</div>

<div class="card" id="output">
–û–∂–∏–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
</div>

</div>

<script>
function analyze(e){
const status=document.getElementById('status');
status.innerText='–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...';

Tesseract.recognize(
e.target.files[0],
'rus',
{logger:m=>{
if(m.progress) status.innerText='OCR '+Math.round(m.progress*100)+'%';
}}
).then(r=>{
status.innerText='–ì–æ—Ç–æ–≤–æ';
processText(r.data.text);
});
}

function processText(text){
const odds=text.match(/\d\.\d{2}/g);
if(!odds || odds.length < 10){
document.getElementById('output').innerHTML=
'<div class="block bad">‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –ª–∏–Ω–∏—é</div>';
return;
}

const nums=odds.map(Number);

// –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å–µ—Ç–∫—É —Ç–æ—Ç–∞–ª–æ–≤
let totals=[
{line:16.5, tm:nums[2], tb:nums[3]},
{line:17.5, tm:nums[4], tb:nums[5]},
{line:18.5, tm:nums[6], tb:nums[7]},
{line:19.5, tm:nums[8], tb:nums[9]},
{line:20.5, tm:nums[10],tb:nums[11]}
];

// –∞–Ω–∞–ª–∏–∑ —Ä–µ–∞–∫—Ü–∏–∏ —Ä—ã–Ω–∫–∞
let analysis=[];
let best=null;
let maxEdge=0;
let lbi=0;

totals.forEach(t=>{
let min=Math.min(t.tm,t.tb);
let max=Math.max(t.tm,t.tb);
let diff=max-min;

lbi+=diff*10;

let side=t.tm>t.tb?'–¢–ë':'–¢–ú';

if(min>=1.70){
let prob=1/max;
let value=(prob*min)-1;

analysis.push({
line:t.line,
side,
odd:min,
diff:diff.toFixed(2),
value:value.toFixed(3)
});

if(value>maxEdge){
maxEdge=value;
best={
line:t.line,
side,
odd:min,
prob,
value
};
}
}
});

lbi=Math.min(100,Math.round(lbi));

// –¥–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ—Å–ª–µ 1-–π –ø–∞—Ä—Ç–∏–∏
let variance='HIGH';
if(lbi>70) variance='LOW';
else if(lbi>45) variance='MEDIUM';

// Kelly (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π)
let kelly=best ? ((best.prob*best.odd-1)/(best.odd-1))*0.25 : 0;
kelly=Math.max(0,kelly);

let decision='‚ùå –ü–†–û–ü–£–°–¢–ò–¢–¨';
let cls='bad';

if(best && best.value>0 && variance!=='HIGH'){
decision='‚úÖ –°–¢–ê–í–ò–¢–¨';
cls='good';
} else if(best && best.value>0){
decision='‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û';
cls='warn';
}

let html=`
<div class="row"><span>–ò–Ω–¥–µ–∫—Å –ø–µ—Ä–µ–∫–æ—Å–∞ –ª–∏–Ω–∏–∏</span><b>${lbi}/100</b></div>
<div class="row"><span>–î–∏—Å–ø–µ—Ä—Å–∏—è</span><b>${variance}</b></div>

<div class="block">
<div class="highlight">üîç –†–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ —Ç–æ—Ç–∞–ª—ã</div>
${analysis.map(a=>`
<div class="row">
<span>${a.side} ${a.line}</span>
<b>${a.odd} | Œî ${a.diff}</b>
</div>
`).join('')}
</div>
`;

if(best){
html+=`
<div class="block good">
<div class="highlight">‚≠ê –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</div>
${best.side} ${best.line} @ ${best.odd}<br>
Value: ${best.value.toFixed(3)}<br>
Kelly (¬º): ${(kelly*100).toFixed(2)}% –±–∞–Ω–∫–∞
</div>
`;
} else {
html+=`
<div class="block bad">
<div class="highlight">‚ùå Value –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã ‚â•1.70 –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
</div>
`;
}

html+=`
<div class="block bad">
<div class="highlight">üö´ –ò—Å–∫–ª—é—á–µ–Ω–æ</div>
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω–∏–∂–µ 1.70<br>
–†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ª–æ–≤—É—à–∫–∏ –ø–æ—Å–ª–µ 1-–π –ø–∞—Ä—Ç–∏–∏
</div>

<div class="block ${cls}">
<div class="decision">${decision}</div>
<div class="small">
LIVE –ø–æ—Å–ª–µ 1-–π –ø–∞—Ä—Ç–∏–∏ ‚Äî –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫, —Ä–∞–±–æ—Ç–∞–µ–º –≤—ã–±–æ—Ä–æ—á–Ω–æ
</div>
</div>
`;

document.getElementById('output').innerHTML=html;
}
</script>

</body>
</html>
